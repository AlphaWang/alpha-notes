# | 客户端

## || Producer



## || Consumer



# |服务端

## || NameServer

目的：

- 为客户端提供关于 topic 的**路由信息**。

  > 生产者如何知道消息要发往那台服务器？
  >
  > 服务器宕机后，生产者如何在不重启的情况下感知？



交互

- Broker 每隔 30s 向 NameServer 的每一台机器发送心跳包，其中包含自身创建的 Topic 路由等信息。
- NameServer 收到心跳包会记录时间戳，每隔 10s 扫描一次 brokerLiveTable，如果发现 120s 内没有收到心跳包，则认为 Broker 失效 --> 更新主题路由信息、将失效的Broker信息移除。
- 客户端每隔 30s 向 NameServer 更新对应的主题路由信息。



## || 消息存储



# | 设计 



## || 主从同步



## || 主从切换





# | 特性

## || 顺序消息



## || 消息过滤



## || 消息回溯



## || 定时消息 



## || 消息重试



# | 运维



## || ACL 



## || Trace



## || 监控